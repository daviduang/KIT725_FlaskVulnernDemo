def login():
    if request.method == 'POST':

        # login form
        username = request.form['username']
        password_typed = request.form['password']

        # create cursor
        cursor = mysql.connection.cursor()

        # get user
        result = cursor.execute('SELECT * FROM users WHERE username = %s', [username] )

        # if user has found
        if result > 0:

            # get hashed password
            data = cursor.fetchone()
            password = data['password'] 

            # check if two passwords matched
            if sha256_crypt.verify(password_typed, password):
                
                session['logged_in'] = True
                session['username'] = username      

                flash('Authentication Sucess!', 'success')
                return redirect(url_for('dashboard'))
            else:
                return render_template('login.html', error='Invalid Login')
        else:
            return render_template('login.html', error='Username Not Found')

    return render_template('login.html')